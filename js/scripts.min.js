"use strict";function s(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e){w.classList[e?"add":"remove"]("_fixed")}function o(e){e=!(!(0<arguments.length&&void 0!==e)||e)||w.classList.contains("_open"),w.classList[e?"remove":"add"]("_open")}function c(){var e,t;window.screen.width<=1201?(r(!1),f.addEventListener("click",o),w.addEventListener("click",function(e){!e.target.closest("[data-menu-exit]")||o(!1)})):(e=a.scrollTop,t=w.classList.contains("_fixed"),500<=e&&!t?r(!0):e<500&&t&&r(!1))}function l(t){return m.find(function(e){return e.id===t})}function u(e,t){if(!e)throw new Error("Такого элемента не существует");p&&p.id!==e.id&&p.classList.remove("_open"),e.classList[t?"add":"remove"]("_open"),p=t?e:void 0}function i(e){u(l(e),!0)}function d(){var e,t;setTimeout(function(){p||i("promo-modal-1")},1e3*(e=25,t=60,Math.random()*(t-e)+e)),m.forEach(function(e){e.addEventListener("click",function(e){!e.target.closest("[data-modal-close]")||u(p,!1)})}),a.addEventListener("click",function(e){e=e.target.closest("[data-open-modal]");!e||i(e.dataset.openModal)})}var p,a=document.querySelector("html"),w=document.querySelector(".header"),f=document.querySelector(".header__toggler"),m=(document.querySelectorAll("[data-menu-exit]"),s(document.querySelectorAll(".modal")));document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".offer__swiper-container.swiper-container")||null,t=document.querySelector(".services__swiper-container.swiper-container")||null,r=document.querySelector(".staff__swiper-container.swiper-container")||null,n=document.querySelector(".portfolio__swiper-container.swiper-container")||null,o=document.querySelector(".promo__swiper-container.swiper-container")||null;e&&new Swiper(".offer__swiper-container",{loop:!0,grabCursor:!0,navigation:{nextEl:".offer__swiper-button-next",prevEl:".offer__swiper-button-prev"},pagination:{el:".offer__swiper-pagination",type:"bullets",clickable:!0},autoplay:{delay:5e3}}),t&&new Swiper(".services__swiper-container",{loop:!1,grabCursor:!0,navigation:{nextEl:".services__swiper-button-next",prevEl:".services__swiper-button-prev"},pagination:{el:".services__swiper-pagination",type:"progressbar"},breakpoints:{320:{slidesPerView:1,spaceBetween:20},899:{slidesPerView:2,spaceBetween:30},1023:{slidesPerView:3,spaceBetween:25}}}),o&&new Swiper(".promo__swiper-container",{loop:!0,grabCursor:!0,navigation:{nextEl:".promo__swiper-button-next",prevEl:".promo__swiper-button-prev"},breakpoints:{320:{slidesPerView:1,spaceBetween:20},769:{slidesPerView:2,spaceBetween:30},1050:{slidesPerView:3,spaceBetween:30},1369:{slidesPerView:4,spaceBetween:25}}}),r&&new Swiper(".staff__swiper-container",{loop:!1,slidesPerView:1,grabCursor:!0,autoHeight:!0,navigation:{nextEl:".staff__swiper-button-next",prevEl:".staff__swiper-button-prev"}}),n&&new Swiper(".portfolio__swiper-container",{loop:!0,spaceBetween:5,grabCursor:!0,breakpoints:{320:{slidesPerView:"auto",centeredSlides:!0},800:{slidesPerView:2,freeMode:!0},1100:{slidesPerView:"auto",centeredSlides:!0}}}),(document.getElementById("map")||null)&&ymaps.ready(function(){new ymaps.Map("map",{center:[55.787851,37.635028],zoom:18}).geoObjects.add(new ymaps.Placemark([55.787864,37.63519],{balloonContent:"Persona BIA. Проспект Мира, 70"},{preset:"islands#blueCircleDotIconWithCaption",iconColor:"red"}))});function i(e){e.preventDefault();try{var t=new FormData(function(e){e=document.getElementById(e);if(e)return e;throw new Error("Форма с таким id не найдена")}(e.target.id));fetch("./mail.php",{method:"POST",body:t}).then(function(e){return console.log(e)}),t="".concat(p&&p.id),u(l(t),!1),e.target.reset()}catch(e){throw e}}var a=s(document.querySelectorAll("form"));a.forEach(function(e){e.addEventListener("submit",i)}),c(),window.addEventListener("scroll",c),d()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImZpeE1lbnVUb2dnbGVyIiwic3RhdHVzIiwiJGhlYWRlciIsImNsYXNzTGlzdCIsIm1lbnVUb2dnbGVyIiwiaXNNZW51T3BlbiIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImNvbnRhaW5zIiwicXVlcnlTZWxlY3RvciIsIiRtZW51VG9nZ2xlciIsImRvY3VtZW50IiwiJGV4aXRNZW51RWxlbXMiLCJhZGRFdmVudExpc3RlbmVyIiwiX3JlZiIsInRhcmdldCIsImNsb3Nlc3QiLCJIVE1MIiwid2luU2Nyb2xsIiwiaXNNZW51Rml4ZWQiLCJjaGVja01lbnVXaW5kb3dXaWR0aCIsImZpbmRNb2RhbEJ5SWQiLCJpZCIsIm1vZGFscyIsImZpbmQiLCJtb2RhbCIsIm1vZGFsVG9nZ2xlciIsIiRlbCIsIkVycm9yIiwiJG9wZW5Nb2RhbCIsImZpbmRNb2RhbEJ5Q2xhc3MiLCJtaW4iLCJtYXgiLCJvcGVuTW9kYWwiLCJNYXRoIiwiZm9yRWFjaCIsIl9yZWYyIiwiX3JlZjMiLCJnZXRSYW5kb21OdW1iZXIiLCJ0YXJnZXRDbG9zZXN0QnV0dG9uIiwiaW5pdE1vZGFsIiwiZGF0YXNldCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfdG9Db25zdW1hYmxlQXJyYXkiLCIkb2ZmZXJTbGlkZXIiLCJpc0Nsb3NlTW9kYWxFbGVtIiwiJHNlcnZpY2VzU2xpZGVyIiwiJHN0YWZmU2xpZGVyIiwiJHByb3Rmb2xpb1NsaWRlciIsIiRwcm9tb1NsaWRlciIsImlzT3Blbk1vZGFsQnV0dG9uIiwiU3dpcGVyIiwibG9vcCIsImdyYWJDdXJzb3IiLCJuYXZpZ2F0aW9uIiwibmV4dEVsIiwiY2xpY2thYmxlIiwib2ZmZXJTbGlkZXIiLCJkZWxheSIsImVsIiwidHlwZSIsImF1dG9wbGF5IiwicGFnaW5hdGlvbiIsInNlcnZpY2VzU2xpZGVyIiwiMzIwIiwic2xpZGVzUGVyVmlldyIsInNwYWNlQmV0d2VlbiIsInByZXZFbCIsIjEwMjMiLCJicmVha3BvaW50cyIsIjc2OSIsImF1dG9IZWlnaHQiLCJjZW50ZXJlZFNsaWRlcyIsIjgwMCIsInByb3Rmb2xpb1NsaWRlciIsImdldEVsZW1lbnRCeUlkIiwieW1hcHMiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwiZ2VvT2JqZWN0cyIsImFkZCIsInJlYWR5IiwiaW5pdCIsImJhbGxvb25Db250ZW50IiwicHJlc2V0IiwiaWNvbkNvbG9yIiwic3VibWl0Rm9ybSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJmb3JtIiwiZm9ybXMiLCJmaW5kRm9ybUJ5SWQiLCJtZXRob2QiLCJib2R5IiwiY29uY2F0IiwiZXJyb3IiLCJ3aW5kb3ciLCJzY3JvbGxUb3AiXSwibWFwcGluZ3MiOiJ1dkJBT3VCLFNBQWpCQSxFQUFpQkMsR0FDbkJDLEVBQVFDLFVBQVVGLEVBQVMsTUFBUSxVQUFVLFVBRzdCLFNBQWRHLEVBQWMsR0FDVkMsTUFENkIsRUFBQUMsVUFBQUMsYUFBQUMsSUFBbkIsSUFBQSxJQUNZTixFQUFRQyxVQUFVTSxTQUFTLFNBQ3ZEUCxFQUFRQyxVQUFXRSxFQUFxQixTQUFSLE9BQWtCLFNBVjdCSyxTQUFuQlIsSUFDQVMsSUFRSU4sRUFDRUYsRUFUTlEsT0FBQUEsT0FBZUMsT0FBU0YsTUFDeEJHLEdBQWlCRCxHQUVqQlosRUFBaUJjLGlCQUFqQmQsUUFBaUJDLEdBQ25CQyxFQUFRQyxpQkFBbUIsUUFBUSxTQUFBWSxJQUFuQ0EsRUFBQUMsT0FESkMsUUFBQSxxQkFnQmdDYixHQUFZLE9BWGxDQyxFQUFtQmEsRUFBR2hCLFVBQ3BCQyxFQUFXRSxFQUFhRixVQUFRTSxTQUFVLFVBZ0I3QixLQUFiVSxJQUFxQkMsRUFiM0JDLEdBQXVCLEdBQ3JCRixFQUF1QixLQUFNQyxHQUM3QnBCLEdBQUEsSUFtQlIsU0FBQXNCLEVBQUFDLEdBY0ksT0FEY0MsRUFBT0MsS0FBSyxTQUFBQyxHQUFLLE9BQUlBLEVBQU1ILEtBQU9BLElBUy9CLFNBQWZJLEVBQWdCQyxFQUFLM0Is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SHFELE9BSS9ESSxnQkFBYSxPQUFBMUQsU0FBQWdFLGVBQUEsUUFBQSxPQVdMSCxNQUFBQSxNQWZ1RCxXQXFCbkUsSUFBQUksTUFBQUMsSUFBQSxNQUFBLENBVUlDLE9BQVEsQ0FBQyxVQUFXLFdBQ3BCQyxLQUFNLEtBUGRDLFdBQVVDLElBQ05MLElBQU1NLE1BQU1DLFVBQ2YsQ0FBQSxVQUFBLFVBV1csQ0FUWkMsZUFBZ0Isa0NBRUYsQ0FDQUMsT0FBQSx1Q0FGVkMsVUFBQSxXQTJCTyxTQUZQQyxFQUVPQyxHQUNIQSxFQUFBQyxpQkFMUixJQWFRLElBQU1DLEVBQVcsSUFBSUMsU0FoQmRoRixTQUFBQSxHQUlMaUYsRUFBT2pGLFNBQVNnRSxlQUFlckQsR0FIekMsR0FBTXVFLEVBS0UsT0FBT0QsRUFGTEEsTUFBSSxJQUFHakYsTUFBU2dFLCtCQVlZbUIsQ0FBYU4sRUFBRXpFLE9BQU9PLEtBSHREbUUsTUFBQUEsYUFBRixDQU1RTSxPQUFRLE9BSlpDLEtBQUFOLElBQ01BLEtBQUFBLFNBQUFBLEdBQVcsT0FBSUMsUUFBU0csSUFBQUEsS0FsT2xDeEUsRUFxT2dCLEdBQUEyRSxPQURRcEUsR0FBQUEsRUFBQVAsSUF0TzVCSSxFQUFBTCxFQUFBQyxJQUFBLEdBd09ZMEUsRUFBQUEsT0FBTU4sUUFGVSxNQUFwQlEsR0FHZ0IsTUFBQUEsR0F4QnZCLElBSUtMLEVBQUtsRCxFQUZQaEMsU0FBQStCLGlCQUFBLFNBMkJJbUQsRUFBQTFELFFBQUEsU0FBQXlELEdBQ0hBLEVBQUEvRSxpQkFBQSxTQUFBMEUsS0FwUkRuRSxJQVNJK0UsT0FBTWpGLGlCQUFpQmtGLFNBQXZCaEYsR0F3UkpvQiIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEhUTUwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJylcclxuXHJcbi8vIC8vIC0tLSDQkdCb0J7QmiDQk9Cb0JDQktCd0J7Qk9CeINCc0JXQndCuIC0tLVxyXG5jb25zdCAkaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcicpXHJcbmNvbnN0ICRtZW51VG9nZ2xlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX3RvZ2dsZXInKVxyXG5jb25zdCAkZXhpdE1lbnVFbGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1lbnUtZXhpdF0nKVxyXG5cclxuY29uc3QgZml4TWVudVRvZ2dsZXIgPSBzdGF0dXMgPT4ge1xyXG4gICAgJGhlYWRlci5jbGFzc0xpc3Rbc3RhdHVzID8gJ2FkZCcgOiAncmVtb3ZlJ10oJ19maXhlZCcpXHJcbn1cclxuXHJcbmNvbnN0IG1lbnVUb2dnbGVyID0gKHN0YXR1cyA9IHRydWUpID0+IHtcclxuICAgIGNvbnN0IGlzTWVudU9wZW4gPSBzdGF0dXMgPyAkaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnX29wZW4nKSA6IHRydWVcclxuICAgICRoZWFkZXIuY2xhc3NMaXN0WyFpc01lbnVPcGVuID8gJ2FkZCcgOiAncmVtb3ZlJ10oJ19vcGVuJylcclxufVxyXG5cclxuY29uc3QgY2hlY2tNZW51V2luZG93V2lkdGggPSAoKSA9PiB7XHJcbiAgICBpZiAod2luZG93LnNjcmVlbi53aWR0aCA8PSAxMjAxKSB7XHJcbiAgICAgICAgZml4TWVudVRvZ2dsZXIoZmFsc2UpXHJcblxyXG4gICAgICAgICRtZW51VG9nZ2xlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG1lbnVUb2dnbGVyKVxyXG4gICAgICAgICRoZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoeyB0YXJnZXQgfSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpc01lbnVFeGl0RWxlbSA9ICEhdGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLW1lbnUtZXhpdF0nKVxyXG4gICAgICAgICAgICBpZiAoaXNNZW51RXhpdEVsZW0pIG1lbnVUb2dnbGVyKGZhbHNlKVxyXG4gICAgICAgIH0pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IHdpblNjcm9sbCA9IEhUTUwuc2Nyb2xsVG9wXHJcbiAgICAgICAgY29uc3QgaXNNZW51Rml4ZWQgPSAkaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnX2ZpeGVkJylcclxuXHJcbiAgICAgICAgaWYgKHdpblNjcm9sbCA+PSA1MDAgJiYgIWlzTWVudUZpeGVkKSB7XHJcbiAgICAgICAgICAgIGZpeE1lbnVUb2dnbGVyKHRydWUpXHJcbiAgICAgICAgfSBlbHNlIGlmICh3aW5TY3JvbGwgPCA1MDAgJiYgaXNNZW51Rml4ZWQpIHtcclxuICAgICAgICAgICAgZml4TWVudVRvZ2dsZXIoZmFsc2UpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vLyDQmNC90LjRhtC40LDQu9C40LfQsNGG0LjRj1xyXG5jb25zdCBpbml0TWVudU9ic2VydmVyID0gKCkgPT4ge1xyXG4gICAgY2hlY2tNZW51V2luZG93V2lkdGgoKVxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGNoZWNrTWVudVdpbmRvd1dpZHRoKVxyXG59XHJcblxyXG4vLyAvL1xyXG5jb25zdCAkbW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1vZGFsJylcclxuY29uc3QgbW9kYWxzID0gWy4uLiRtb2RhbHNdXHJcblxyXG5sZXQgJG9wZW5Nb2RhbFxyXG5cclxuY29uc3QgZmluZE1vZGFsQnlJZCA9IGlkID0+IHtcclxuICAgIGNvbnN0IG1vZGFsID0gbW9kYWxzLmZpbmQobW9kYWwgPT4gbW9kYWwuaWQgPT09IGlkKVxyXG4gICAgcmV0dXJuIG1vZGFsXHJcbn1cclxuXHJcbmNvbnN0IGZpbmRNb2RhbEJ5Q2xhc3MgPSBjbGFzc05hbWUgPT4ge1xyXG4gICAgY29uc3QgbW9kYWwgPSBtb2RhbHMuZmluZChtb2RhbCA9PiBtb2RhbC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKSlcclxuICAgIHJldHVybiBtb2RhbFxyXG59XHJcblxyXG5jb25zdCBtb2RhbFRvZ2dsZXIgPSAoJGVsLCBzdGF0dXMpID0+IHtcclxuICAgIGlmICghJGVsKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfQotCw0LrQvtCz0L4g0Y3Qu9C10LzQtdC90YLQsCDQvdC1INGB0YPRidC10YHRgtCy0YPQtdGCJylcclxuICAgIH1cclxuICAgIGlmICgkb3Blbk1vZGFsICYmICRvcGVuTW9kYWwuaWQgIT09ICRlbC5pZCkge1xyXG4gICAgICAgICRvcGVuTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnX29wZW4nKVxyXG4gICAgfVxyXG5cclxuICAgICRlbC5jbGFzc0xpc3Rbc3RhdHVzID8gJ2FkZCcgOiAncmVtb3ZlJ10oJ19vcGVuJylcclxuICAgICRvcGVuTW9kYWwgPSBzdGF0dXMgPyAkZWwgOiB1bmRlZmluZWRcclxufVxyXG5cclxuY29uc3Qgb3Blbk1vZGFsID0gaWQgPT4ge1xyXG4gICAgbW9kYWxUb2dnbGVyKGZpbmRNb2RhbEJ5SWQoaWQpLCB0cnVlKVxyXG59XHJcblxyXG5jb25zdCBjbG9zZU1vZGFsID0gaWQgPT4ge1xyXG4gICAgbW9kYWxUb2dnbGVyKGZpbmRNb2RhbEJ5SWQoaWQpLCBmYWxzZSlcclxufVxyXG5cclxuY29uc3QgZ2V0UmFuZG9tTnVtYmVyID0gKG1pbiwgbWF4KSA9PiB7XHJcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluXHJcbn1cclxuXHJcbmNvbnN0IGluaXRNb2RhbCA9ICgpID0+IHtcclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGlmICghJG9wZW5Nb2RhbCkge1xyXG4gICAgICAgICAgICBvcGVuTW9kYWwoJ3Byb21vLW1vZGFsLTEnKVxyXG4gICAgICAgIH1cclxuICAgIH0sIGdldFJhbmRvbU51bWJlcigyNSwgNjApICogMTAwMClcclxuXHJcbiAgICBtb2RhbHMuZm9yRWFjaChtb2RhbCA9PiB7XHJcbiAgICAgICAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoeyB0YXJnZXQgfSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpc0Nsb3NlTW9kYWxFbGVtID0gISF0YXJnZXQuY2xvc2VzdCgnW2RhdGEtbW9kYWwtY2xvc2VdJylcclxuICAgICAgICAgICAgaWYgKCFpc0Nsb3NlTW9kYWxFbGVtKSByZXR1cm5cclxuICAgICAgICAgICAgbW9kYWxUb2dnbGVyKCRvcGVuTW9kYWwsIGZhbHNlKVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxuICAgIEhUTUwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoeyB0YXJnZXQgfSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHRhcmdldENsb3Nlc3RCdXR0b24gPSB0YXJnZXQuY2xvc2VzdCgnW2RhdGEtb3Blbi1tb2RhbF0nKVxyXG4gICAgICAgIGNvbnN0IGlzT3Blbk1vZGFsQnV0dG9uID0gISF0YXJnZXRDbG9zZXN0QnV0dG9uXHJcblxyXG4gICAgICAgIGlmIChpc09wZW5Nb2RhbEJ1dHRvbikge1xyXG4gICAgICAgICAgICBvcGVuTW9kYWwodGFyZ2V0Q2xvc2VzdEJ1dHRvbi5kYXRhc2V0Lm9wZW5Nb2RhbClcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59XHJcblxyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcclxuICAgIC8vIC8vXHJcbmNvbnN0ICRvZmZlclNsaWRlciA9XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub2ZmZXJfX3N3aXBlci1jb250YWluZXIuc3dpcGVyLWNvbnRhaW5lcicpIHx8IG51bGxcclxuY29uc3QgJHNlcnZpY2VzU2xpZGVyID1cclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZXJ2aWNlc19fc3dpcGVyLWNvbnRhaW5lci5zd2lwZXItY29udGFpbmVyJykgfHxcclxuICAgIG51bGxcclxuY29uc3QgJHN0YWZmU2xpZGVyID1cclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdGFmZl9fc3dpcGVyLWNvbnRhaW5lci5zd2lwZXItY29udGFpbmVyJykgfHwgbnVsbFxyXG5jb25zdCAkcHJvdGZvbGlvU2xpZGVyID1cclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3J0Zm9saW9fX3N3aXBlci1jb250YWluZXIuc3dpcGVyLWNvbnRhaW5lcicpIHx8XHJcbiAgICBudWxsXHJcbmNvbnN0ICRwcm9tb1NsaWRlciA9XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvbW9fX3N3aXBlci1jb250YWluZXIuc3dpcGVyLWNvbnRhaW5lcicpIHx8IG51bGxcclxuXHJcbmlmICgkb2ZmZXJTbGlkZXIpIHtcclxuICAgIGNvbnN0IG9mZmVyU2xpZGVyID0gbmV3IFN3aXBlcignLm9mZmVyX19zd2lwZXItY29udGFpbmVyJywge1xyXG4gICAgICAgIGxvb3A6IHRydWUsXHJcbiAgICAgICAgZ3JhYkN1cnNvcjogdHJ1ZSxcclxuICAgICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgICAgIG5leHRFbDogJy5vZmZlcl9fc3dpcGVyLWJ1dHRvbi1uZXh0JyxcclxuICAgICAgICAgICAgcHJldkVsOiAnLm9mZmVyX19zd2lwZXItYnV0dG9uLXByZXYnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGFnaW5hdGlvbjoge1xyXG4gICAgICAgICAgICBlbDogJy5vZmZlcl9fc3dpcGVyLXBhZ2luYXRpb24nLFxyXG4gICAgICAgICAgICB0eXBlOiAnYnVsbGV0cycsXHJcbiAgICAgICAgICAgIGNsaWNrYWJsZTogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGF1dG9wbGF5OiB7XHJcbiAgICAgICAgICAgIGRlbGF5OiA1MDAwLFxyXG4gICAgICAgIH0sXHJcbiAgICB9KVxyXG59XHJcblxyXG5pZiAoJHNlcnZpY2VzU2xpZGVyKSB7XHJcbiAgICBjb25zdCBzZXJ2aWNlc1NsaWRlciA9IG5ldyBTd2lwZXIoJy5zZXJ2aWNlc19fc3dpcGVyLWNvbnRhaW5lcicsIHtcclxuICAgICAgICBsb29wOiBmYWxzZSxcclxuICAgICAgICBncmFiQ3Vyc29yOiB0cnVlLFxyXG4gICAgICAgIG5hdmlnYXRpb246IHtcclxuICAgICAgICAgICAgbmV4dEVsOiAnLnNlcnZpY2VzX19zd2lwZXItYnV0dG9uLW5leHQnLFxyXG4gICAgICAgICAgICBwcmV2RWw6ICcuc2VydmljZXNfX3N3aXBlci1idXR0b24tcHJldicsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwYWdpbmF0aW9uOiB7XHJcbiAgICAgICAgICAgIGVsOiAnLnNlcnZpY2VzX19zd2lwZXItcGFnaW5hdGlvbicsXHJcbiAgICAgICAgICAgIHR5cGU6ICdwcm9ncmVzc2JhcicsXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYnJlYWtwb2ludHM6IHtcclxuICAgICAgICAgICAgMzIwOiB7XHJcbiAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyMCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgODk5OiB7XHJcbiAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAyLFxyXG4gICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAzMCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgMTAyMzoge1xyXG4gICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMyxcclxuICAgICAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogMjUsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSxcclxuICAgIH0pXHJcbn1cclxuXHJcbmlmICgkcHJvbW9TbGlkZXIpIHtcclxuICAgIGNvbnN0IHByb21vU2xpZGVyID0gbmV3IFN3aXBlcignLnByb21vX19zd2lwZXItY29udGFpbmVyJywge1xyXG4gICAgICAgIGxvb3A6IHRydWUsXHJcbiAgICAgICAgZ3JhYkN1cnNvcjogdHJ1ZSxcclxuICAgICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgICAgIG5leHRFbDogJy5wcm9tb19fc3dpcGVyLWJ1dHRvbi1uZXh0JyxcclxuICAgICAgICAgICAgcHJldkVsOiAnLnByb21vX19zd2lwZXItYnV0dG9uLXByZXYnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYnJlYWtwb2ludHM6IHtcclxuICAgICAgICAgICAgMzIwOiB7XHJcbiAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyMCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgNzY5OiB7XHJcbiAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAyLFxyXG4gICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAzMCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgMTA1MDoge1xyXG4gICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMyxcclxuICAgICAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogMzAsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIDEzNjk6IHtcclxuICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDQsXHJcbiAgICAgICAgICAgICAgICBzcGFjZUJldHdlZW46IDI1LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICB9KVxyXG59XHJcblxyXG5pZiAoJHN0YWZmU2xpZGVyKSB7XHJcbiAgICBjb25zdCBzdGFmZlNsaWRlciA9IG5ldyBTd2lwZXIoJy5zdGFmZl9fc3dpcGVyLWNvbnRhaW5lcicsIHtcclxuICAgICAgICBsb29wOiBmYWxzZSxcclxuICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgICAgIGdyYWJDdXJzb3I6IHRydWUsXHJcbiAgICAgICAgYXV0b0hlaWdodDogdHJ1ZSxcclxuICAgICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgICAgIG5leHRFbDogJy5zdGFmZl9fc3dpcGVyLWJ1dHRvbi1uZXh0JyxcclxuICAgICAgICAgICAgcHJldkVsOiAnLnN0YWZmX19zd2lwZXItYnV0dG9uLXByZXYnLFxyXG4gICAgICAgIH0sXHJcbiAgICB9KVxyXG59XHJcblxyXG5pZiAoJHByb3Rmb2xpb1NsaWRlcikge1xyXG4gICAgY29uc3QgcHJvdGZvbGlvU2xpZGVyID0gbmV3IFN3aXBlcignLnBvcnRmb2xpb19fc3dpcGVyLWNvbnRhaW5lcicsIHtcclxuICAgICAgICBsb29wOiB0cnVlLFxyXG4gICAgICAgIHNwYWNlQmV0d2VlbjogNSxcclxuICAgICAgICBncmFiQ3Vyc29yOiB0cnVlLFxyXG4gICAgICAgIGJyZWFrcG9pbnRzOiB7XHJcbiAgICAgICAgICAgIDMyMDoge1xyXG4gICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogJ2F1dG8nLFxyXG4gICAgICAgICAgICAgICAgY2VudGVyZWRTbGlkZXM6IHRydWUsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIDgwMDoge1xyXG4gICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMixcclxuICAgICAgICAgICAgICAgIGZyZWVNb2RlOiB0cnVlLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAxMTAwOiB7XHJcbiAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAnYXV0bycsXHJcbiAgICAgICAgICAgICAgICBjZW50ZXJlZFNsaWRlczogdHJ1ZSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgfSlcclxufVxyXG5cclxuICAgIC8vIC8vXHJcblxyXG5jb25zdCAkbWFwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpIHx8IG51bGxcclxuXHJcbmlmICgkbWFwKSB7XHJcbiAgICB5bWFwcy5yZWFkeShpbml0KVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0KCkge1xyXG4gICAgY29uc3QgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKCdtYXAnLCB7XHJcbiAgICAgICAgY2VudGVyOiBbNTUuNzg3ODUxLCAzNy42MzUwMjhdLFxyXG4gICAgICAgIHpvb206IDE4LFxyXG4gICAgfSlcclxuXHJcbiAgICBteU1hcC5nZW9PYmplY3RzLmFkZChcclxuICAgICAgICBuZXcgeW1hcHMuUGxhY2VtYXJrKFxyXG4gICAgICAgICAgICBbNTUuNzg3ODY0LCAzNy42MzUxOV0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJhbGxvb25Db250ZW50OiAnUGVyc29uYSBCSUEuINCf0YDQvtGB0L/QtdC60YIg0JzQuNGA0LAsIDcwJyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcHJlc2V0OiAnaXNsYW5kcyNibHVlQ2lyY2xlRG90SWNvbldpdGhDYXB0aW9uJyxcclxuICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3JlZCcsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgKSxcclxuICAgIClcclxufVxyXG5cclxuICAgIC8vIC8vXHJcbmNvbnN0ICRmb3JtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Zvcm0nKVxyXG5jb25zdCBmb3JtcyA9IFsuLi4kZm9ybXNdXHJcblxyXG5jb25zdCBmaW5kRm9ybUJ5SWQgPSBpZCA9PiB7XHJcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXHJcbiAgICBpZiAoISFmb3JtKSB7XHJcbiAgICAgICAgcmV0dXJuIGZvcm1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfQpNC+0YDQvNCwINGBINGC0LDQutC40LwgaWQg0L3QtSDQvdCw0LnQtNC10L3QsCcpXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IHN1Ym1pdEZvcm0gPSBlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZmluZEZvcm1CeUlkKGUudGFyZ2V0LmlkKSlcclxuXHJcbiAgICAgICAgZmV0Y2goJy4vbWFpbC5waHAnLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBib2R5OiBmb3JtRGF0YSxcclxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IGNvbnNvbGUubG9nKHJlc3BvbnNlKSlcclxuXHJcbiAgICAgICAgY2xvc2VNb2RhbChgJHskb3Blbk1vZGFsICYmICRvcGVuTW9kYWwuaWR9YClcclxuICAgICAgICBlLnRhcmdldC5yZXNldCgpXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHRocm93IGVycm9yXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IGluaXRGb3Jtc0hhZGxlciA9ICgpID0+IHtcclxuICAgIGZvcm1zLmZvckVhY2goZm9ybSA9PiB7XHJcbiAgICAgICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBzdWJtaXRGb3JtKVxyXG4gICAgfSlcclxufVxyXG5cclxuaW5pdEZvcm1zSGFkbGVyKClcclxuXHJcblxyXG4gICAgaW5pdE1lbnVPYnNlcnZlcigpXHJcbiAgICBpbml0TW9kYWwoKVxyXG59KVxyXG4iXX0=
